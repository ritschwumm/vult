let legend =
  let version = Core.Version.version in
  {pla|/* This code was generated by the Vult compiler <#version#s> https://github.com/modlfo/vult */|pla}


let setExt ext output =
  match output with
  | None -> "output" ^ ext
  | Some file -> file ^ ext


let splitArray into elems =
  let rec loop current acc count elems =
    match elems with
    | [] -> List.rev (List.rev current :: acc)
    | h :: t when count < into -> loop (h :: current) acc (count + 1) t
    | h :: t -> loop [ h ] (List.rev current :: acc) 0 t
  in
  loop [] [] 0 elems
